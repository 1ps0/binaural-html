<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Therapeutic Frequencies Dashboard</title>
    <style>
        :root {
            --primary: #3a86ff;
            --secondary: #8338ec;
            --success: #06d6a0;
            --info: #118ab2;
            --warning: #ffd166;
            --danger: #ef476f;
            --light: #f8f9fa;
            --dark: #212529;
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
            background-color: #f5f7fa;
            padding-bottom: 100px; /* Space for fixed controls */
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: var(--gradient);
            color: white;
            padding: 20px 0;
            text-align: center;
            border-radius: 0 0 10px 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            margin: 0;
            font-size: 2.5rem;
        }
        
        h2 {
            color: var(--secondary);
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 10px;
            margin-top: 40px;
            font-size: 1.8rem;
        }
        
        h3 {
            color: var(--primary);
            font-size: 1.3rem;
            margin-top: 25px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-top: 10px;
        }
        
        .sticky-controls {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 15px;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .sticky-controls.top {
            top: 0;
            bottom: auto;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .sticky-controls.minimized {
            transform: translateY(calc(100% - 40px));
        }
        
        .sticky-controls.top.minimized {
            transform: translateY(calc(-100% + 40px));
        }
        
        .control-bar-handle {
            height: 25px;
            width: 100%;
            position: absolute;
            top: -25px;
            left: 0;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 5px 5px 0 0;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
            z-index: 999;
        }
        
        .sticky-controls.top .control-bar-handle {
            top: auto;
            bottom: -25px;
            border-radius: 0 0 5px 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .control-bar-buttons {
            display: flex;
            position: absolute;
            right: 15px;
            top: -25px;
            gap: 5px;
        }
        
        .sticky-controls.top .control-bar-buttons {
            top: auto;
            bottom: -25px;
        }
        
        .control-bar-button {
            width: 25px;
            height: 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
        }
        
        .control-bar-button:hover {
            background-color: #2a75ee;
        }
        
        .controls-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .volume-container {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            min-width: 200px;
        }
        
        .buttons-container {
            display: flex;
            gap: 10px;
        }
        
        .active-tones {
            flex: 1;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            min-height: 40px;
            align-items: center;
        }
        
        .active-tone {
            background: var(--light);
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 5px 10px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .active-tone.binaural {
            background-color: #e6f0ff;
            border-color: var(--primary);
        }
        
        .active-tone.solfeggio {
            background-color: #f0e6ff;
            border-color: var(--secondary);
        }
        
        .active-tone.special {
            background-color: #e6fff0;
            border-color: var(--success);
        }
        
        .remove-tone {
            cursor: pointer;
            color: #999;
            font-weight: bold;
            font-size: 1.2rem;
            line-height: 1;
        }
        
        .remove-tone:hover {
            color: var(--danger);
        }
        
        label {
            font-weight: 600;
            color: var(--dark);
        }
        
        input[type="range"] {
            flex: 1;
            height: 8px;
            -webkit-appearance: none;
            background: #ddd;
            border-radius: 5px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }
        
        .volume-value {
            min-width: 40px;
            text-align: center;
            font-weight: bold;
        }
        
        .button {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .button:hover {
            background-color: #2a75ee;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .button.stop {
            background-color: var(--danger);
        }
        
        .button.stop:hover {
            background-color: #e02e57;
        }
        
        .button.test {
            background-color: var(--info);
        }
        
        .button.test:hover {
            background-color: #0e7a9a;
        }
        
        .frequency-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            background: var(--gradient);
            color: white;
            padding: 15px;
            position: relative;
        }
        
        .frequency {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 15px;
            font-weight: bold;
        }
        
        .card-body {
            padding: 15px;
            color: #666;
        }
        
        .card-title {
            margin: 0;
            font-size: 1.5rem;
            color: white;
        }
        
        .card-description {
            margin-top: 10px;
            margin-bottom: 15px;
            font-size: 0.95rem;
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
        }
        
        .card-button {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            flex: 1;
            font-weight: 600;
            transition: all 0.2s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
        }
        
        .card-button:hover {
            background-color: #2a75ee;
        }
        
        .card-button.playing {
            background-color: var(--success);
        }
        
        .card-button.playing:hover {
            background-color: #05b589;
        }
        
        .play-icon, .pause-icon {
            display: inline-block;
            width: 0;
            height: 0;
            margin-right: 5px;
        }
        
        .play-icon {
            border-top: 7px solid transparent;
            border-bottom: 7px solid transparent;
            border-left: 12px solid currentColor;
        }
        
        .pause-icon {
            width: 10px;
            height: 14px;
            border-right: 3px solid currentColor;
            border-left: 3px solid currentColor;
            margin-right: 7px;
        }
        
        .binaural {
            background: linear-gradient(135deg, #3a86ff, #0096c7);
        }
        
        .binaural .card-button {
            background-color: #0096c7;
        }
        
        .binaural .card-button:hover {
            background-color: #0077b6;
        }
        
        .solfeggio {
            background: linear-gradient(135deg, #8338ec, #5e60ce);
        }
        
        .solfeggio .card-button {
            background-color: #5e60ce;
        }
        
        .solfeggio .card-button:hover {
            background-color: #4f44d1;
        }
        
        .special {
            background: linear-gradient(135deg, #06d6a0, #118ab2);
        }
        
        .special .card-button {
            background-color: #118ab2;
        }
        
        .special .card-button:hover {
            background-color: #0e7a9a;
        }
        
        .status {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-left: 5px solid var(--primary);
            display: none;
        }
        
        .status.active {
            display: block;
        }
        
        .status.playing {
            border-left-color: var(--success);
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f5f7fa;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
            font-weight: 600;
            opacity: 0.7;
        }
        
        .tab.active {
            background-color: white;
            opacity: 1;
            position: relative;
            top: 1px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .info-panel {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .toggle-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background-color: #6c757d;
            transition: background-color 0.2s ease;
        }
        
        .toggle-icon.active {
            background-color: var(--success);
        }
        
        .card.pinned {
            background-color: #f8f9ff;
            box-shadow: 0 3px 15px rgba(58, 134, 255, 0.2);
            border: 1px solid rgba(58, 134, 255, 0.3);
            order: -1; /* Move to the start of the container */
        }
        
        .card.pinned .pin-button {
            opacity: 1;
            background-color: rgba(255, 255, 255, 0.4);
            color: #ffcc00;
            text-shadow: 0 0 3px rgba(0, 0, 0, 0.3);
        }
        
        .pin-button {
            position: absolute;
            top: 15px;
            right: 80px;
            background-color: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: white;
            opacity: 0.7;
            z-index: 2;
            transition: all 0.2s ease;
        }
        
        .pin-button:hover {
            background-color: rgba(255, 255, 255, 0.4);
            transform: scale(1.1);
        }
        
        /* Pinned section */
        .pinned-section {
            margin-bottom: 30px;
            display: none; /* Hidden by default, shown when there are pinned cards */
        }
        
        .pinned-section.active {
            display: block;
        }
        
        .pinned-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        /* View toggle styles */
        .view-toggle-container {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .view-toggle-label {
            margin-right: 10px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .view-toggle {
            display: flex;
            background-color: #eee;
            border-radius: 30px;
            padding: 3px;
            position: relative;
            cursor: pointer;
            width: 120px;
            justify-content: space-between;
        }
        
        .view-toggle-option {
            padding: 5px 10px;
            text-align: center;
            z-index: 1;
            flex: 1;
            color: #666;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .view-toggle-option.active {
            color: #fff;
        }
        
        .view-toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 60px;
            height: calc(100% - 6px);
            background-color: var(--primary);
            border-radius: 30px;
            transition: all 0.3s ease;
        }
        
        .view-toggle.list .view-toggle-slider {
            left: calc(50% + 3px);
        }
        
        /* List view styles */
        .frequency-cards.list-view {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .frequency-cards.list-view .card {
            display: flex;
            flex-direction: row;
            align-items: center;
            height: auto;
            padding: 0;
            overflow: visible;
        }
        
        .frequency-cards.list-view .card:hover {
            transform: none;
        }
        
        .frequency-cards.list-view .card-header {
            width: 200px;
            min-width: 200px;
            height: 70px;
            border-radius: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .frequency-cards.list-view .card-title {
            font-size: 1.1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .frequency-cards.list-view .card-body {
            flex: 1;
            display: flex;
            flex-direction: row;
            align-items: center;
            padding: 10px;
        }
        
        .frequency-cards.list-view .card-description {
            flex: 1;
            margin: 0 15px 0 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: calc(100% - 150px);
        }
        
        .frequency-cards.list-view .card-actions {
            width: 120px;
            min-width: 120px;
            margin-left: auto;
        }
        
        .frequency-cards.list-view .pin-button {
            top: 20px;
            right: 135px;
        }
        
        .frequency-cards.list-view .frequency {
            top: auto;
            bottom: 10px;
            font-size: 0.8rem;
        }
        
        /* Pinned cards in list view */
        .pinned-cards.list-view {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .pinned-cards.list-view .card {
            display: flex;
            flex-direction: row;
            align-items: center;
            height: auto;
            padding: 0;
        }
        
        /* Enhanced mobile styles */
        @media (max-width: 768px) {
            .controls-container {
                flex-direction: column;
                align-items: stretch;
            }
            
            .frequency-cards {
                grid-template-columns: 1fr;
            }
            
            .pinned-cards {
                grid-template-columns: 1fr;
            }
            
            .sticky-controls {
                padding: 10px;
            }
            
            .buttons-container {
                width: 100%;
                justify-content: space-between;
            }
            
            .volume-container {
                width: 100%;
            }
            
            .active-tones {
                margin-top: 10px;
                order: 3;
            }
            
            /* Mobile optimizations for list view */
            .frequency-cards.list-view .card-header {
                width: 120px;
                min-width: 120px;
            }
            
            .frequency-cards.list-view .card-description {
                display: none;
            }
            
            .frequency-cards.list-view .pin-button {
                right: 130px;
            }
            
            /* Make buttons larger for touch targets */
            .card-button, .button, .control-bar-button {
                min-height: 44px;  /* Apple's recommended min touch target size */
                padding: 12px 20px;
            }
            
            .control-bar-button {
                width: 44px;
                height: 44px;
            }
            
            .pin-button {
                width: 44px;
                height: 44px;
                font-size: 20px;
            }
            
            /* Adjust spacing for mobile */
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.5rem;
            }
            
            .container {
                padding: 10px;
            }
            
            /* Improved mobile header */
            header {
                padding: 15px 0;
            }
            
            .subtitle {
                font-size: 1rem;
            }
            
            /* Better controls when at top on mobile */
            .sticky-controls.top {
                top: 0;
            }
            
            body.controls-top {
                padding-top: 130px;
                padding-bottom: 0;
            }
            
            body.controls-bottom {
                padding-bottom: 130px;
                padding-top: 0;
            }
            
            /* Enhance view toggle for touch */
            .view-toggle {
                width: 140px;
                height: 40px;
            }
            
            .view-toggle-option {
                padding: 10px;
            }
            
            .view-toggle-slider {
                width: 70px;
            }
            
            /* Adjust list view for mobile */
            .frequency-cards.list-view .card-title {
                font-size: 1rem;
            }
            
            /* Bottom fixed controls improvements for mobile */
            .sticky-controls.minimized {
                transform: translateY(calc(100% - 50px));
            }
            
            .sticky-controls.top.minimized {
                transform: translateY(calc(-100% + 50px));
            }
            
            .control-bar-handle {
                height: 35px;
                top: -35px;
            }
            
            .sticky-controls.top .control-bar-handle {
                bottom: -35px;
            }
            
            .filter-container {
                width: 100%;
            }
            
            input[type="text"], input[type="range"] {
                font-size: 16px; /* Prevents iOS zoom on input */
                height: 44px;
                padding: 0 10px;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 480px) {
            .card-button {
                font-size: 0.9rem;
                padding: 10px;
            }
            
            .card-actions {
                gap: 5px;
            }
            
            .frequency-cards.list-view .card-header {
                width: 100px;
                min-width: 100px;
            }
            
            .frequency {
                font-size: 0.8rem;
                padding: 3px 6px;
            }
            
            /* Enhance the minimized control bar for very small screens */
            .control-bar-buttons {
                gap: 2px;
            }
            
            .control-bar-button {
                width: 35px;
                height: 35px;
            }
        }
        
        /* Safe area insets for notched phones */
        @supports (padding: max(0px)) {
            .sticky-controls {
                padding-bottom: max(15px, env(safe-area-inset-bottom));
                padding-left: max(15px, env(safe-area-inset-left));
                padding-right: max(15px, env(safe-area-inset-right));
            }
            
            .sticky-controls.top {
                padding-top: max(15px, env(safe-area-inset-top));
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Therapeutic Frequencies Dashboard</h1>
            <p class="subtitle">Binaural Beats, Solfeggio Tones & Healing Frequencies</p>
        </div>
    </header>
    
    <div class="container">
        <div id="status" class="status">Ready to play frequencies</div>
        
        <div class="tabs">
            <div class="tab active" data-tab="frequencies">Frequencies</div>
            <div class="tab" data-tab="info">Information</div>
        </div>
        
        <div class="tab-content active" id="frequencies-tab">
            <div class="view-toggle-container">
                <span class="view-toggle-label">View:</span>
                <div class="view-toggle">
                    <span class="view-toggle-option cards-option active">Cards</span>
                    <span class="view-toggle-option list-option">List</span>
                    <span class="view-toggle-slider"></span>
                </div>
            </div>
            
            <h2>Binaural Beats (Brain Wave States)</h2>
            <p>Binaural beats occur when two slightly different frequencies are played separately to each ear, creating a perceived beat at the difference frequency. For best results, use headphones.</p>
            
            <div id="binaural-pinned" class="pinned-section">
                <h3>Pinned Binaural Beats</h3>
                <div class="pinned-cards" id="binaural-pinned-cards"></div>
            </div>
            
            <div class="frequency-cards">
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Cognitive Enhancement</h3>
                        <span class="frequency">40 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Gamma waves associated with improved cognitive function, memory, and perception. May have benefits for neurological conditions.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="40" data-carrier="200" data-name="40Hz Cognitive" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Meditation</h3>
                        <span class="frequency">6 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Theta waves associated with deep meditation, spiritual awareness, and creative insight. Helps quiet the mind.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="6" data-carrier="200" data-name="6Hz Meditation" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Relaxation</h3>
                        <span class="frequency">10 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Alpha waves associated with relaxed alertness, calm focus, and positive thinking. Helps reduce anxiety.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="10" data-carrier="200" data-name="10Hz Relaxation" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Focus</h3>
                        <span class="frequency">15 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Beta waves associated with increased concentration, alertness, and problem-solving abilities.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="15" data-carrier="200" data-name="15Hz Focus" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Deep Sleep</h3>
                        <span class="frequency">3 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Delta waves associated with deep, restorative sleep and healing. Helps with insomnia and rejuvenation.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="3" data-carrier="200" data-name="3Hz Sleep" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Healing</h3>
                        <span class="frequency">2.5 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Delta waves associated with pain relief, healing, and deep relaxation. Helps release growth hormone.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="2.5" data-carrier="200" data-name="2.5Hz Healing" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Creative</h3>
                        <span class="frequency">7.5 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Theta waves associated with creative inspiration, emotional release, and intuitive insights.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="7.5" data-carrier="200" data-name="7.5Hz Creative" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Dream State</h3>
                        <span class="frequency">4.5 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Theta waves associated with REM sleep, vivid dreams, and accessing the subconscious mind.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="4.5" data-carrier="200" data-name="4.5Hz Dream" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Learn</h3>
                        <span class="frequency">12 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Alpha/Beta bridge frequency associated with information processing, learning, and comprehension.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="12" data-carrier="200" data-name="12Hz Learning" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Alert</h3>
                        <span class="frequency">18 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Beta waves associated with alertness, problem-solving, and active thinking.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="18" data-carrier="200" data-name="18Hz Alertness" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Analytical</h3>
                        <span class="frequency">25 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">High beta waves associated with analytical thinking, mental activity, and logical processing.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="25" data-carrier="200" data-name="25Hz Analytical" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header binaural">
                        <h3 class="card-title">Mental Clarity</h3>
                        <span class="frequency">35 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Gamma waves associated with mental clarity, heightened perception, and higher consciousness.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="35" data-carrier="200" data-name="35Hz Clarity" data-type="binaural">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <h2>Solfeggio Frequencies</h2>
            <p>Ancient musical tones said to have various healing and spiritual effects. These frequencies are played as pure tones.</p>
            
            <div id="solfeggio-pinned" class="pinned-section">
                <h3>Pinned Solfeggio Frequencies</h3>
                <div class="pinned-cards" id="solfeggio-pinned-cards"></div>
            </div>
            
            <div class="frequency-cards">
                <div class="card">
                    <div class="card-header solfeggio">
                        <h3 class="card-title">MI - Transformation</h3>
                        <span class="frequency">528 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Known as the "Love Frequency" and associated with DNA repair and cellular healing. Helps transformation and miracles.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="528" data-name="528Hz Transformation" data-type="solfeggio">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header solfeggio">
                        <h3 class="card-title">Universal Harmony</h3>
                        <span class="frequency">432 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Said to resonate with the universe and have calming, healing properties. Alternative to standard 440Hz tuning.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="432" data-name="432Hz Harmony" data-type="solfeggio">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header solfeggio">
                        <h3 class="card-title">UT - Liberation</h3>
                        <span class="frequency">396 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Helps liberate guilt and fear. Assists in releasing negative beliefs and emotional patterns.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="396" data-name="396Hz Liberation" data-type="solfeggio">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header solfeggio">
                        <h3 class="card-title">RE - Change</h3>
                        <span class="frequency">417 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Facilitates change and undoing situations. Helps cleanse traumatic experiences and remove negative energy.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="417" data-name="417Hz Change" data-type="solfeggio">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header solfeggio">
                        <h3 class="card-title">FA - Connection</h3>
                        <span class="frequency">639 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Enhances understanding, tolerance, and love in relationships. Promotes connectivity and harmony.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="639" data-name="639Hz Connection" data-type="solfeggio">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header solfeggio">
                        <h3 class="card-title">SOL - Intuition</h3>
                        <span class="frequency">741 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Awakens intuition and helps with expression and problem-solving. Cleanses cells from toxins.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="741" data-name="741Hz Intuition" data-type="solfeggio">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header solfeggio">
                        <h3 class="card-title">LA - Spiritual Order</h3>
                        <span class="frequency">852 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Returns to spiritual order and awakens intuition. Helps transform consciousness and expand awareness.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="852" data-name="852Hz Spiritual" data-type="solfeggio">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <h2>Special Frequencies</h2>
            <p>Additional therapeutic frequencies with specific healing and wellness benefits.</p>
            
            <div id="special-pinned" class="pinned-section">
                <h3>Pinned Special Frequencies</h3>
                <div class="pinned-cards" id="special-pinned-cards"></div>
            </div>
            
            <div class="frequency-cards">
                <div class="card">
                    <div class="card-header special">
                        <h3 class="card-title">Schumann Resonance</h3>
                        <span class="frequency">7.83 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Earth's natural electromagnetic frequency. Associated with grounding, wellbeing, and synchronizing with Earth's rhythms.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="7.83" data-name="7.83Hz Schumann" data-type="special">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header special">
                        <h3 class="card-title">Cell Regeneration</h3>
                        <span class="frequency">111 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Associated with cell regeneration and beta-endorphin release. May help with cellular health and pain relief.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="111" data-name="111Hz Cell Regeneration" data-type="special">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header special">
                        <h3 class="card-title">Higher Consciousness</h3>
                        <span class="frequency">963 Hz</span>
                    </div>
                    <div class="card-body">
                        <p class="card-description">Associated with awakening perfect state and connection to higher consciousness. Activates the crown chakra.</p>
                        <div class="card-actions">
                            <button class="card-button play-toggle-button" data-freq="963" data-name="963Hz Consciousness" data-type="special">
                                <span class="play-icon"></span> Play
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="info-tab">
            <div class="info-panel">
                <h2>About Frequency Therapy</h2>
                <p>Frequency therapy is based on the concept that specific sound frequencies can influence our physical bodies and mental states. The use of frequencies for healing and meditation has roots in ancient practices and is now being explored with modern technology.</p>
                
                <h3>Brain Wave Frequencies</h3>
                <p>Our brains naturally produce waves at various frequencies, each associated with different states of consciousness:</p>
                <ul>
                    <li><strong>Delta waves (0.5-4 Hz):</strong> Deep sleep, healing, rejuvenation</li>
                    <li><strong>Theta waves (4-8 Hz):</strong> Meditation, creativity, REM sleep</li>
                    <li><strong>Alpha waves (8-14 Hz):</strong> Relaxed awareness, light meditation, learning</li>
                    <li><strong>Beta waves (14-30 Hz):</strong> Active thinking, focus, alertness</li>
                    <li><strong>Gamma waves (30-100 Hz):</strong> Higher cognitive processing, peak awareness</li>
                </ul>
                
                <h3>Binaural Beats Explained</h3>
                <p>Binaural beats are an auditory illusion. When two slightly different frequencies are played separately to each ear, the brain perceives a third tone – the mathematical difference between the two frequencies.</p>
                <p>For example, if 200 Hz is played in the left ear and 210 Hz in the right, the brain perceives a 10 Hz beat. This can help entrain your brainwaves to specific frequencies.</p>
                <p><strong>For proper binaural beats effect, headphones are essential.</strong></p>
                
                <h3>Solfeggio Frequencies</h3>
                <p>The Solfeggio frequencies are a set of six tones that were allegedly used in ancient Gregorian chants. Each frequency is said to have specific healing properties:</p>
                <ul>
                    <li><strong>396 Hz (UT):</strong> Liberating guilt and fear</li>
                    <li><strong>417 Hz (RE):</strong> Undoing situations and facilitating change</li>
                    <li><strong>528 Hz (MI):</strong> Transformation and miracles (DNA repair)</li>
                    <li><strong>639 Hz (FA):</strong> Connecting/relationships</li>
                    <li><strong>741 Hz (SOL):</strong> Awakening intuition</li>
                    <li><strong>852 Hz (LA):</strong> Returning to spiritual order</li>
                </ul>
                
                <h3>Scientific Research</h3>
                <p>Research on frequency therapy is ongoing. Some findings suggest potential benefits:</p>
                <ul>
                    <li>40 Hz stimulation has shown promising results for Alzheimer's research</li>
                    <li>Certain frequencies may influence mood and stress levels</li>
                    <li>Binaural beats may help with focus, relaxation, and sleep quality</li>
                </ul>
                <p>However, individual results vary, and frequency therapy should complement, not replace, conventional medical treatment.</p>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>Therapeutic Frequencies Dashboard | Use with headphones for best results | Press "Stop All" to end playback</p>
        </div>
    </footer>

    <!-- Persistent Controls Bar -->
    <div class="sticky-controls">
        <div class="control-bar-handle" id="controlBarHandle">
            <span>≡ Control Panel</span>
        </div>
        <div class="control-bar-buttons">
            <button class="control-bar-button" id="togglePosition" title="Toggle Position">⇅</button>
            <button class="control-bar-button" id="toggleMinimize" title="Minimize">—</button>
        </div>
        <div class="controls-container">
            <div class="volume-container">
                <label for="volume">Volume:</label>
                <input type="range" id="volume" min="0" max="1" step="0.01" value="0.2">
                <span class="volume-value">20%</span>
            </div>
            
            <div class="buttons-container">
                <button id="stopButton" class="button stop" disabled>Stop</button>
                <button id="stopAllButton" class="button stop" disabled>Stop All</button>
                <button id="testButton" class="button test">Test</button>
            </div>
            
            <div class="filter-container">
                <input type="text" id="frequencyFilter" placeholder="Filter frequencies..." class="filter-input">
            </div>
            
            <div class="active-tones">
                <!-- Active tones will be displayed here -->
            </div>
        </div>
    </div>

    <script>
        // Audio Context and global variables
        let audioContext;
        let oscillators = {};  // Changed to object to track multiple oscillators
        let gainNodes = {};    // Individual gain nodes for each oscillator
        let masterGainNode;
        let activeOscillators = []; // Track active oscillator IDs
        
        // DOM Elements
        const volumeSlider = document.getElementById('volume');
        const volumeValue = document.querySelector('.volume-value');
        const stopButton = document.getElementById('stopButton');
        const stopAllButton = document.getElementById('stopAllButton');
        const testButton = document.getElementById('testButton');
        const statusElement = document.getElementById('status');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const frequencyFilter = document.getElementById('frequencyFilter');
        const activeTonesList = document.querySelector('.active-tones');
        
        // Initialize volume display
        volumeValue.textContent = `${Math.round(volumeSlider.value * 100)}%`;
        
        // Setup Audio Context with user interaction
        function setupAudioContext() {
            if (!audioContext) {
                // Create audio context on first user interaction
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Create master gain node
                masterGainNode = audioContext.createGain();
                masterGainNode.gain.value = volumeSlider.value;
                masterGainNode.connect(audioContext.destination);
            }
        }
        
        // Update volume when slider changes
        volumeSlider.addEventListener('input', () => {
            const volumePercent = Math.round(volumeSlider.value * 100);
            volumeValue.textContent = `${volumePercent}%`;
            
            if (masterGainNode) {
                masterGainNode.gain.value = volumeSlider.value;
                
                // Update all individual gain nodes
                Object.keys(gainNodes).forEach(id => {
                    gainNodes[id].gain.value = volumeSlider.value;
                });
            }
        });
        
        // Generate a unique ID for each oscillator
        function generateOscillatorId(freq, type) {
            return `${type}-${freq}`;
        }
        
        // Stop a specific oscillator
        function stopOscillator(id) {
            if (oscillators[id]) {
                oscillators[id].stop();
                oscillators[id].disconnect();
                delete oscillators[id];
                delete gainNodes[id];
                
                // Also stop the right ear oscillator for binaural beats
                const rightEarId = `${id}-right`;
                if (oscillators[rightEarId]) {
                    oscillators[rightEarId].stop();
                    oscillators[rightEarId].disconnect();
                    delete oscillators[rightEarId];
                }
                
                // Remove from active oscillators
                const index = activeOscillators.indexOf(id);
                if (index > -1) {
                    activeOscillators.splice(index, 1);
                }
                
                // Remove from active tones display
                const toneElement = document.getElementById(`tone-${id}`);
                if (toneElement) {
                    toneElement.remove();
                }
                
                // Update toggle buttons
                updateToggleButton(id, false);
                
                // Update control buttons state
                updateControlButtonsState();
                
                // Update status
                updateStatus();
            }
        }
        
        // Stop all audio
        function stopAllAudio() {
            // Create a copy of the keys to avoid issues during deletion
            const oscillatorIds = Object.keys(oscillators);
            
            oscillatorIds.forEach(id => {
                // Stop and disconnect each oscillator
                if (oscillators[id]) {
                    oscillators[id].stop();
                    oscillators[id].disconnect();
                    
                    // Update toggle buttons for main oscillators (not right ear)
                    if (!id.endsWith('-right')) {
                        updateToggleButton(id, false);
                    }
                }
            });
            
            // Clear all oscillators and gain nodes
            oscillators = {};
            gainNodes = {};
            activeOscillators = [];
            
            // Clear active tones display
            activeTonesList.innerHTML = '';
            
            // Update buttons state
            stopButton.disabled = true;
            stopAllButton.disabled = true;
            
            // Update status
            statusElement.textContent = 'All audio stopped';
            statusElement.className = 'status active';
        }
        
        // Stop button - stops most recently added tone
        stopButton.addEventListener('click', () => {
            if (activeOscillators.length > 0) {
                // Stop the most recently added oscillator
                const lastOscillatorId = activeOscillators[activeOscillators.length - 1];
                stopOscillator(lastOscillatorId);
            }
        });
        
        // Stop All button
        stopAllButton.addEventListener('click', stopAllAudio);
        
        // Update the status display
        function updateStatus() {
            if (activeOscillators.length === 0) {
                statusElement.textContent = 'Ready to play frequencies';
                statusElement.className = 'status active';
            } else if (activeOscillators.length === 1) {
                const id = activeOscillators[0];
                const name = id.split('-')[1] + ' Hz ' + id.split('-')[0];
                statusElement.textContent = `Playing ${name}`;
                statusElement.className = 'status active playing';
            } else {
                statusElement.textContent = `Playing ${activeOscillators.length} frequencies`;
                statusElement.className = 'status active playing';
            }
        }
        
        // Add tone to active tones display
        function addActiveTonesDisplay(id, name, type) {
            const toneElement = document.createElement('div');
            toneElement.className = `active-tone ${type}`;
            toneElement.id = `tone-${id}`;
            toneElement.innerHTML = `
                <span>${name}</span>
                <span class="remove-tone" data-id="${id}">&times;</span>
            `;
            activeTonesList.appendChild(toneElement);
            
            // Add click event for remove button
            toneElement.querySelector('.remove-tone').addEventListener('click', function() {
                const oscillatorId = this.getAttribute('data-id');
                stopOscillator(oscillatorId);
            });
        }
        
        // Update control buttons state
        function updateControlButtonsState() {
            stopButton.disabled = activeOscillators.length === 0;
            stopAllButton.disabled = activeOscillators.length === 0;
        }
        
        // Update toggle button appearance
        function updateToggleButton(id, isActive) {
            // Find all toggle buttons matching this id
            document.querySelectorAll(`.play-toggle-button[data-freq="${id.split('-')[1]}"][data-type="${id.split('-')[0]}"]`).forEach(button => {
                if (isActive) {
                    button.classList.add('playing');
                } else {
                    button.classList.remove('playing');
                }
            });
        }
        
        // Create and play a pure tone
        function playTone(frequency, name, type = 'tone') {
            setupAudioContext();
            
            const oscillatorId = generateOscillatorId(type, frequency);
            
            // If this oscillator is already playing, stop it
            if (oscillators[oscillatorId]) {
                stopOscillator(oscillatorId);
                return;
            }
            
            // Create oscillator
            const oscillator = audioContext.createOscillator();
            oscillator.type = 'sine';
            oscillator.frequency.value = frequency;
            
            // Create individual gain node
            const gainNode = audioContext.createGain();
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(volumeSlider.value, audioContext.currentTime + 0.05);
            
            // Connect and start
            oscillator.connect(gainNode);
            gainNode.connect(masterGainNode);
            oscillator.start();
            
            // Store oscillator and gain node
            oscillators[oscillatorId] = oscillator;
            gainNodes[oscillatorId] = gainNode;
            activeOscillators.push(oscillatorId);
            
            // Update display and controls
            addActiveTonesDisplay(oscillatorId, name, type);
            updateToggleButton(oscillatorId, true);
            updateControlButtonsState();
            updateStatus();
        }
        
        // Create and play a binaural beat
        function playBinaural(beatFreq, carrierFreq, name) {
            setupAudioContext();
            
            const oscillatorId = generateOscillatorId('binaural', beatFreq);
            
            // If this oscillator is already playing, stop it
            if (oscillators[oscillatorId]) {
                stopOscillator(oscillatorId);
                return;
            }
            
            // Create oscillator for left ear
            const leftOsc = audioContext.createOscillator();
            leftOsc.type = 'sine';
            leftOsc.frequency.value = carrierFreq;
            
            // Create oscillator for right ear
            const rightOsc = audioContext.createOscillator();
            rightOsc.type = 'sine';
            rightOsc.frequency.value = carrierFreq + parseFloat(beatFreq);
            
            // Create channel merger for stereo output
            const merger = audioContext.createChannelMerger(2);
            
            // Create individual gain node
            const gainNode = audioContext.createGain();
            gainNode.gain.setValueAtTime(0, audioContext.currentTime);
            gainNode.gain.linearRampToValueAtTime(volumeSlider.value, audioContext.currentTime + 0.05);
            
            // Connect everything
            leftOsc.connect(merger, 0, 0);  // Left channel
            rightOsc.connect(merger, 0, 1); // Right channel
            merger.connect(gainNode);
            gainNode.connect(masterGainNode);
            
            // Start oscillators - we store the left one as the main oscillator
            leftOsc.start();
            rightOsc.start();
            
            // Store oscillators and gain node - we need to track the right oscillator separately
            oscillators[oscillatorId] = leftOsc;
            oscillators[oscillatorId + '-right'] = rightOsc;
            gainNodes[oscillatorId] = gainNode;
            activeOscillators.push(oscillatorId);
            
            // Update display and controls
            addActiveTonesDisplay(oscillatorId, name, 'binaural');
            updateToggleButton(oscillatorId, true);
            updateControlButtonsState();
            updateStatus();
        }
        
        // Test button - plays short samples of different frequencies
        testButton.addEventListener('click', async function() {
            setupAudioContext();
            
            statusElement.textContent = 'Starting test sequence...';
            statusElement.className = 'status active';
            
            // Stop any playing tones
            stopAllAudio();
            
            // Define test frequencies
            const testSequence = [
                { type: 'binaural', freq: 40, carrier: 200, name: '40Hz Cognitive Enhancement' },
                { type: 'binaural', freq: 6, carrier: 200, name: '6Hz Meditation' },
                { type: 'binaural', freq: 10, carrier: 200, name: '10Hz Relaxation' },
                { type: 'tone', freq: 528, name: '528Hz Transformation' },
                { type: 'tone', freq: 432, name: '432Hz Universal Harmony' }
            ];
            
            for (const item of testSequence) {
                // Stop previous sound
                stopAllAudio();
                
                // Update status
                statusElement.textContent = `Testing: ${item.name}`;
                
                // Play current test sound
                if (item.type === 'binaural') {
                    playBinaural(item.freq, item.carrier, item.name);
                } else {
                    playTone(item.freq, item.name, 'solfeggio');
                }
                
                // Wait 3 seconds
                await new Promise(resolve => setTimeout(resolve, 3000));
            }
            
            // Stop after test sequence
            stopAllAudio();
            statusElement.textContent = 'Test sequence completed';
        });
        
        // Event listeners for play buttons
        document.querySelectorAll('.play-toggle-button').forEach(button => {
            button.addEventListener('click', function() {
                const freq = parseFloat(this.getAttribute('data-freq'));
                const name = this.getAttribute('data-name');
                const type = this.getAttribute('data-type');
                
                // Generate oscillator ID
                let oscillatorId;
                if (type === 'binaural') {
                    oscillatorId = generateOscillatorId('binaural', freq);
                } else {
                    oscillatorId = generateOscillatorId(type, freq);
                }
                
                // Check if already playing
                if (oscillators[oscillatorId]) {
                    // Stop playing
                    stopOscillator(oscillatorId);
                    this.innerHTML = '<span class="play-icon"></span> Play';
                    this.classList.remove('playing');
                } else {
                    // Start playing
                    if (type === 'binaural') {
                        const carrier = parseFloat(this.getAttribute('data-carrier'));
                        playBinaural(freq, carrier, name);
                    } else {
                        playTone(freq, name, type);
                    }
                    this.innerHTML = '<span class="pause-icon"></span> Pause';
                    this.classList.add('playing');
                }
            });
        });
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                tabs.forEach(t => t.classList.remove('active'));
                
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Hide all tab contents
                tabContents.forEach(content => content.classList.remove('active'));
                
                // Show corresponding tab content
                const tabId = this.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // Filter functionality
        frequencyFilter.addEventListener('input', function() {
            const filterValue = this.value.toLowerCase();
            const cards = document.querySelectorAll('.card');
            
            cards.forEach(card => {
                const title = card.querySelector('.card-title').textContent.toLowerCase();
                const description = card.querySelector('.card-description').textContent.toLowerCase();
                const frequency = card.querySelector('.frequency').textContent.toLowerCase();
                
                if (title.includes(filterValue) || description.includes(filterValue) || frequency.includes(filterValue)) {
                    card.style.display = '';
                } else {
                    card.style.display = 'none';
                }
            });
        });
        
        // Pin card functionality
        let pinnedCards = {
            binaural: [],
            solfeggio: [],
            special: []
        };
        
        function initializePinButtons() {
            // Add pin button to all cards
            document.querySelectorAll('.card-header').forEach(header => {
                if (!header.querySelector('.pin-button')) {
                    const pinButton = document.createElement('button');
                    pinButton.className = 'pin-button';
                    pinButton.innerHTML = '📌';
                    pinButton.title = 'Pin this frequency';
                    header.appendChild(pinButton);
                    
                    // Add pin/unpin functionality
                    pinButton.addEventListener('click', function(event) {
                        event.stopPropagation();
                        const card = this.closest('.card');
                        const cardType = getCardType(card);
                        const cardId = getCardId(card);
                        const isPinned = card.classList.contains('pinned');
                        
                        if (isPinned) {
                            // Unpin the card
                            card.classList.remove('pinned');
                            
                            // Remove from pinned array
                            const index = pinnedCards[cardType].indexOf(cardId);
                            if (index > -1) {
                                pinnedCards[cardType].splice(index, 1);
                            }
                        } else {
                            // Pin the card
                            card.classList.add('pinned');
                            
                            // Add to pinned array if not already there
                            if (!pinnedCards[cardType].includes(cardId)) {
                                pinnedCards[cardType].push(cardId);
                            }
                        }
                        
                        // Update pinned sections
                        updatePinnedSections();
                        
                        // Save pinned state to localStorage
                        savePinnedCards();
                    });
                }
            });
        }
        
        function getCardType(card) {
            const header = card.querySelector('.card-header');
            if (header.classList.contains('binaural')) return 'binaural';
            if (header.classList.contains('solfeggio')) return 'solfeggio';
            return 'special';
        }
        
        function getCardId(card) {
            const button = card.querySelector('.play-toggle-button');
            const freq = button.getAttribute('data-freq');
            const name = button.getAttribute('data-name');
            return `${freq}-${name}`;
        }
        
        function updatePinnedSections() {
            // For each type of frequency
            Object.keys(pinnedCards).forEach(type => {
                const pinnedSection = document.getElementById(`${type}-pinned`);
                const pinnedContainer = document.getElementById(`${type}-pinned-cards`);
                
                // Clear the container
                pinnedContainer.innerHTML = '';
                
                // If we have pinned cards, show the section
                if (pinnedCards[type].length > 0) {
                    pinnedSection.classList.add('active');
                    
                    // For each pinned card ID
                    pinnedCards[type].forEach(cardId => {
                        // Find the matching card
                        const freq = cardId.split('-')[0];
                        const allCards = document.querySelectorAll(`.card`);
                        
                        allCards.forEach(card => {
                            const button = card.querySelector('.play-toggle-button');
                            if (button && button.getAttribute('data-freq') === freq && getCardType(card) === type) {
                                // Clone the card and add to pinned section
                                const clone = card.cloneNode(true);
                                pinnedContainer.appendChild(clone);
                                
                                // Add event listeners to the clone
                                const cloneButton = clone.querySelector('.play-toggle-button');
                                cloneButton.addEventListener('click', function() {
                                    // Find the original button and click it
                                    button.click();
                                    
                                    // Update this button's state to match
                                    this.innerHTML = button.innerHTML;
                                    if (button.classList.contains('playing')) {
                                        this.classList.add('playing');
                                    } else {
                                        this.classList.remove('playing');
                                    }
                                });
                                
                                // Add pin button functionality to the clone
                                const clonePinButton = clone.querySelector('.pin-button');
                                clonePinButton.addEventListener('click', function() {
                                    // Find the original pin button and click it
                                    card.querySelector('.pin-button').click();
                                });
                            }
                        });
                    });
                } else {
                    // Hide the section if no pinned cards
                    pinnedSection.classList.remove('active');
                }
            });
        }
        
        function savePinnedCards() {
            localStorage.setItem('pinnedCards', JSON.stringify(pinnedCards));
        }
        
        function loadPinnedCards() {
            const saved = localStorage.getItem('pinnedCards');
            if (saved) {
                pinnedCards = JSON.parse(saved);
                
                // Mark cards as pinned
                document.querySelectorAll('.card').forEach(card => {
                    const cardType = getCardType(card);
                    const cardId = getCardId(card);
                    
                    if (pinnedCards[cardType].includes(cardId)) {
                        card.classList.add('pinned');
                    }
                });
                
                // Update pinned sections
                updatePinnedSections();
            }
        }
        
        // View toggle functionality
        const viewToggle = document.querySelector('.view-toggle');
        const cardsOption = document.querySelector('.cards-option');
        const listOption = document.querySelector('.list-option');
        let currentView = 'cards'; // Default view
        
        // Load saved view preference
        function loadViewPreference() {
            const savedView = localStorage.getItem('frequencyView');
            if (savedView) {
                currentView = savedView;
                updateViewToggle();
                updateAllContainers();
            }
        }
        
        // Save view preference
        function saveViewPreference() {
            localStorage.setItem('frequencyView', currentView);
        }
        
        // Update toggle appearance
        function updateViewToggle() {
            if (currentView === 'list') {
                viewToggle.classList.add('list');
                cardsOption.classList.remove('active');
                listOption.classList.add('active');
            } else {
                viewToggle.classList.remove('list');
                cardsOption.classList.add('active');
                listOption.classList.remove('active');
            }
        }
        
        // Update all containers with the current view
        function updateAllContainers() {
            const allCardContainers = document.querySelectorAll('.frequency-cards, .pinned-cards');
            allCardContainers.forEach(container => {
                if (currentView === 'list') {
                    container.classList.add('list-view');
                } else {
                    container.classList.remove('list-view');
                }
            });
        }
        
        // Toggle between views
        viewToggle.addEventListener('click', function() {
            currentView = currentView === 'cards' ? 'list' : 'cards';
            updateViewToggle();
            updateAllContainers();
            saveViewPreference();
        });
        
        // Initialize additional functionality when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Remove the scroll listener as we now have manual controls
            window.removeEventListener('scroll', function() {});
            
            // Update body padding to accommodate the control bar
            document.body.style.paddingBottom = '100px';
            
            // Initialize pin buttons
            initializePinButtons();
            
            // Load pinned cards from localStorage
            loadPinnedCards();
            
            // Load view preference
            loadViewPreference();
            
            // Set initial body class for controls position
            document.body.classList.add('controls-bottom');
            
            // Add touch event improvements
            document.querySelectorAll('.card-button, .button, .control-bar-button').forEach(button => {
                button.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.97)';
                });
                
                button.addEventListener('touchend', function() {
                    this.style.transform = '';
                });
            });
            
            // Prevent double-tap zoom on buttons
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('touchend', function(e) {
                    e.preventDefault();
                });
            });
            
            // Add meta theme-color based on scheme
            const metaThemeColor = document.createElement('meta');
            metaThemeColor.name = 'theme-color';
            metaThemeColor.content = '#3a86ff';
            document.head.appendChild(metaThemeColor);
        });
        
        // Control bar functionality
        const controlBar = document.querySelector('.sticky-controls');
        const controlBarHandle = document.getElementById('controlBarHandle');
        const togglePositionButton = document.getElementById('togglePosition');
        const toggleMinimizeButton = document.getElementById('toggleMinimize');
        
        // Toggle minimize/maximize
        toggleMinimizeButton.addEventListener('click', () => {
            controlBar.classList.toggle('minimized');
            toggleMinimizeButton.textContent = controlBar.classList.contains('minimized') ? '□' : '—';
            toggleMinimizeButton.title = controlBar.classList.contains('minimized') ? 'Maximize' : 'Minimize';
        });
        
        // Toggle position (top/bottom) with body class update for padding
        togglePositionButton.addEventListener('click', () => {
            controlBar.classList.toggle('top');
            
            // Update body padding to accommodate the control bar
            if (controlBar.classList.contains('top')) {
                document.body.classList.remove('controls-bottom');
                document.body.classList.add('controls-top');
                document.body.style.paddingTop = '100px';
                document.body.style.paddingBottom = '0px';
            } else {
                document.body.classList.remove('controls-top');
                document.body.classList.add('controls-bottom');
                document.body.style.paddingTop = '0px';
                document.body.style.paddingBottom = '100px';
            }
        });
        
        // Click on handle to toggle minimize
        controlBarHandle.addEventListener('click', () => {
            controlBar.classList.toggle('minimized');
            toggleMinimizeButton.textContent = controlBar.classList.contains('minimized') ? '□' : '—';
            toggleMinimizeButton.title = controlBar.classList.contains('minimized') ? 'Maximize' : 'Minimize';
        });
    </script>
</body>
</html>